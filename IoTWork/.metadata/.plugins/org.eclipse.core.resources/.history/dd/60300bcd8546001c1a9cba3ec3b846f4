package basic;

import org.eclipse.paho.client.mqttv3.IMqttDeliveryToken;
import org.eclipse.paho.client.mqttv3.MqttCallback;
import org.eclipse.paho.client.mqttv3.MqttClient;
import org.eclipse.paho.client.mqttv3.MqttConnectOptions;
import org.eclipse.paho.client.mqttv3.MqttException;
import org.eclipse.paho.client.mqttv3.MqttMessage;

//mqtt클라이언트 작성 - subscriber
//구독신청을 하고 메시지가 전달되는 것을 대기
//1. MqttCallback인터페이스를 상속
//2. MqttCallback인터페이스의 메소드를 오버라이딩
//3. MqttClient객체를 만들기 - broker와 통신하는 역할을 담당, subscriber, publisher의 역할을 담당
//4. MqttConnectOptions를 이용해서 MQTT의 연결정보를 설정한다.
public class MyMqtt_Sub_client implements MqttCallback {
	private MqttClient mqttclient;
	private MqttConnectOptions mqttOption;
	public MyMqtt_Sub_client init(String server,String clientId) {
		//mqtt클라이언트가 연결하기 위해서 필요한 정보를 설정
		mqttOption = new MqttConnectOptions();
		mqttOption.setCleanSession(true);
		mqttOption.setKeepAliveInterval(30);
		try {
			//broker에 subscribe하기 위한 클라이언트객체를 생성
			mqttclient = new MqttClient(server, clientId);
		} catch (MqttException e) {
			e.printStackTrace();
		}
		
		return this;
	}
	//커넥션이 종료되면 호출 - 통신오류로 연결이 끊어진 경우에 호출
	@Override
	public void connectionLost(Throwable arg0) {
		
	}
	//메시지 배달이 완료되면 호출
	@Override
	public void deliveryComplete(IMqttDeliveryToken arg0) {
		
	}
	//메시지가 도착하면 호출되는 메소드 - topic(broker구동신청한 topic명), MqttMessage는 메시지 
	@Override
	public void messageArrived(String topic, MqttMessage message) throws Exception {
		// TODO Auto-generated method stub
		
	}
	public static void main(String[] args) {
		// TODO Auto-generated method stub

	}
}
